<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Meta-Analysis and Network Meta-Analysis • pharmhand</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Meta-Analysis and Network Meta-Analysis">
<meta name="description" content="Comprehensive guide to pairwise meta-analysis, indirect comparison, network meta-analysis, and Bayesian meta-analysis using pharmhand for HTA submissions.
">
<meta property="og:description" content="Comprehensive guide to pairwise meta-analysis, indirect comparison, network meta-analysis, and Bayesian meta-analysis using pharmhand for HTA submissions.
">
<meta property="og:image" content="https://sims1253.github.io/pharmhand/branch/dev/reference/figures/logo.png">
<meta property="og:image:alt" content="pharmhand hex logo">
<meta name="twitter:card" content="summary">
<meta name="twitter:creator" content="@scholzmx">
<meta name="twitter:site" content="@scholzmx">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">pharmhand</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="Released version">0.4.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/pharmhand.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sims1253/pharmhand/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch">
<li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul>
</li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Meta-Analysis and Network Meta-Analysis</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sims1253/pharmhand/blob/dev/vignettes/meta-analysis.Rmd" class="external-link"><code>vignettes/meta-analysis.Rmd</code></a></small>
      <div class="d-none name"><code>meta-analysis.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://sims1253.github.io/pharmhand" class="external-link">pharmhand</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>pharmhand provides comprehensive functions for meta-analysis and
network meta-analysis (NMA), supporting German HTA requirements
(G-BA/IQWiG).</p>
</div>
<div class="section level2">
<h2 id="pairwise-meta-analysis">Pairwise Meta-Analysis<a class="anchor" aria-label="anchor" href="#pairwise-meta-analysis"></a>
</h2>
<div class="section level3">
<h3 id="basic-meta-analysis">Basic Meta-Analysis<a class="anchor" aria-label="anchor" href="#basic-meta-analysis"></a>
</h3>
<p>The [<code><a href="../reference/meta_analysis.html">meta_analysis()</a></code>] function performs fixed or random
effects meta-analysis.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Five studies with hazard ratios</span></span>
<span><span class="va">yi</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.82</span>, <span class="fl">0.68</span>, <span class="fl">0.91</span>, <span class="fl">0.77</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sei</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.12</span>, <span class="fl">0.15</span>, <span class="fl">0.18</span>, <span class="fl">0.14</span>, <span class="fl">0.11</span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/meta_analysis.html">meta_analysis</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  study_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Study"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>  effect_measure <span class="op">=</span> <span class="st">"hr"</span>,</span>
<span>  model <span class="op">=</span> <span class="st">"random"</span>,</span>
<span>  method <span class="op">=</span> <span class="st">"REML"</span>,</span>
<span>  knapp_hartung <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">result</span><span class="op">@</span><span class="va">estimate</span></span>
<span><span class="co">#&gt; [1] 0.7823178</span></span>
<span><span class="va">result</span><span class="op">@</span><span class="va">ci</span></span>
<span><span class="co">#&gt; [1] 0.6840484 0.8947045</span></span>
<span><span class="va">result</span><span class="op">@</span><span class="va">heterogeneity</span><span class="op">$</span><span class="va">I2</span></span>
<span><span class="co">#&gt; [1] 0</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="heterogeneity-assessment">Heterogeneity Assessment<a class="anchor" aria-label="anchor" href="#heterogeneity-assessment"></a>
</h3>
<p>The [<code><a href="../reference/calculate_heterogeneity.html">calculate_heterogeneity()</a></code>] function computes
heterogeneity statistics including Q, I², and τ².</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">het</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_heterogeneity.html">calculate_heterogeneity</a></span><span class="op">(</span><span class="va">yi</span>, <span class="va">sei</span>, method <span class="op">=</span> <span class="st">"REML"</span><span class="op">)</span></span>
<span><span class="va">het</span><span class="op">$</span><span class="va">Q</span></span>
<span><span class="co">#&gt; [1] 2.009819</span></span>
<span><span class="va">het</span><span class="op">$</span><span class="va">I2</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">het</span><span class="op">$</span><span class="va">tau2</span></span>
<span><span class="co">#&gt; [1] 214637.8</span></span>
<span><span class="va">het</span><span class="op">$</span><span class="va">interpretation</span></span>
<span><span class="co">#&gt; [1] "Low heterogeneity"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="leave-one-out-sensitivity-analysis">Leave-One-Out Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#leave-one-out-sensitivity-analysis"></a>
</h3>
<p>The [<code><a href="../reference/leave_one_out.html">leave_one_out()</a></code>] function performs leave-one-out
sensitivity analysis to identify influential studies.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">loo</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/leave_one_out.html">leave_one_out</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="va">loo</span><span class="op">$</span><span class="va">results</span><span class="op">[</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"excluded_study"</span>, <span class="st">"estimate_display"</span>, <span class="st">"I2"</span><span class="op">)</span><span class="op">]</span></span>
<span><span class="co">#&gt;   excluded_study estimate_display I2</span></span>
<span><span class="co">#&gt; 1        Study 1        0.7906126  0</span></span>
<span><span class="co">#&gt; 2        Study 2        0.7731710  0</span></span>
<span><span class="co">#&gt; 3        Study 3        0.8102179  0</span></span>
<span><span class="co">#&gt; 4        Study 4        0.7533013  0</span></span>
<span><span class="co">#&gt; 5        Study 5        0.7854280  0</span></span>
<span><span class="va">loo</span><span class="op">$</span><span class="va">influential_studies</span></span>
<span><span class="co">#&gt; [1] "Study 3" "Study 4"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="forest-plot">Forest Plot<a class="anchor" aria-label="anchor" href="#forest-plot"></a>
</h3>
<p>The [<code><a href="../reference/create_meta_forest_plot.html">create_meta_forest_plot()</a></code>] function creates forest
plots for visualizing meta-analysis results.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_meta_forest_plot.html">create_meta_forest_plot</a></span><span class="op">(</span><span class="va">result</span>, title <span class="op">=</span> <span class="st">"Treatment Effect (HR)"</span><span class="op">)</span></span>
<span><span class="va">plot</span><span class="op">@</span><span class="va">plot</span></span>
<span><span class="co">#&gt; Warning in ggplot2::scale_x_log10(limits = xlim): <span style="color: #00BB00;">log-10</span></span></span>
<span><span class="co">#&gt; transformation introduced infinite values.</span></span>
<span><span class="co">#&gt; `height` was translated to `width`.</span></span></code></pre></div>
<p><img src="meta-analysis_files/figure-html/forest-1.png" class="r-plt" alt="Meta-analysis forest plot" width="672"></p>
</div>
<div class="section level3">
<h3 id="funnel-plot-and-publication-bias">Funnel Plot and Publication Bias<a class="anchor" aria-label="anchor" href="#funnel-plot-and-publication-bias"></a>
</h3>
<p>The [<code><a href="../reference/create_funnel_plot.html">create_funnel_plot()</a></code>] function creates funnel plots
to assess publication bias.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">funnel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_funnel_plot.html">create_funnel_plot</a></span><span class="op">(</span><span class="va">result</span>, title <span class="op">=</span> <span class="st">"Funnel Plot"</span><span class="op">)</span></span>
<span><span class="va">funnel</span><span class="op">@</span><span class="va">plot</span></span></code></pre></div>
<p><img src="meta-analysis_files/figure-html/funnel-1.png" class="r-plt" alt="Funnel plot" width="672"></p>
<p>The [<code><a href="../reference/eggers_test.html">eggers_test()</a></code>] function performs Egger’s test for
funnel plot asymmetry.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">egger</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/eggers_test.html">eggers_test</a></span><span class="op">(</span>yi <span class="op">=</span> <span class="va">yi</span>, sei <span class="op">=</span> <span class="va">sei</span><span class="op">)</span></span>
<span><span class="va">egger</span><span class="op">$</span><span class="va">p_value</span></span>
<span><span class="co">#&gt; [1] 0.8929091</span></span>
<span><span class="va">egger</span><span class="op">$</span><span class="va">interpretation</span></span>
<span><span class="co">#&gt; [1] "No significant asymmetry detected (p &gt;= 0.10)"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="trim-and-fill">Trim-and-Fill<a class="anchor" aria-label="anchor" href="#trim-and-fill"></a>
</h3>
<p>The [<code><a href="../reference/trim_and_fill.html">trim_and_fill()</a></code>] function performs trim-and-fill
analysis to adjust for publication bias.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">tf</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/trim_and_fill.html">trim_and_fill</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></span>
<span><span class="va">tf</span><span class="op">$</span><span class="va">n_imputed</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="va">tf</span><span class="op">$</span><span class="va">interpretation</span></span>
<span><span class="co">#&gt; [1] "No missing studies detected"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="indirect-comparison">Indirect Comparison<a class="anchor" aria-label="anchor" href="#indirect-comparison"></a>
</h2>
<p>The [<code><a href="../reference/indirect_comparison.html">indirect_comparison()</a></code>] function performs indirect
comparisons using the Bucher method.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bucher method: A vs B via common comparator C</span></span>
<span><span class="va">indirect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/indirect_comparison.html">indirect_comparison</a></span><span class="op">(</span></span>
<span>  effect_ab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span>,  <span class="co"># A vs C</span></span>
<span>  se_ab <span class="op">=</span> <span class="fl">0.12</span>,</span>
<span>  effect_bc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.85</span><span class="op">)</span>,  <span class="co"># B vs C</span></span>
<span>  se_bc <span class="op">=</span> <span class="fl">0.10</span>,</span>
<span>  effect_measure <span class="op">=</span> <span class="st">"hr"</span>,</span>
<span>  label_a <span class="op">=</span> <span class="st">"Drug A"</span>,</span>
<span>  label_b <span class="op">=</span> <span class="st">"Placebo"</span>,</span>
<span>  label_c <span class="op">=</span> <span class="st">"Drug B"</span></span>
<span><span class="op">)</span></span>
<span><span class="va">indirect</span><span class="op">@</span><span class="va">estimate</span></span>
<span><span class="co">#&gt; [1] 0.8823529</span></span>
<span><span class="va">indirect</span><span class="op">@</span><span class="va">ci</span></span>
<span><span class="co">#&gt; [1] 0.6496514 1.1984068</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="network-meta-analysis">Network Meta-Analysis<a class="anchor" aria-label="anchor" href="#network-meta-analysis"></a>
</h2>
<p>The [<code><a href="../reference/network_meta.html">network_meta()</a></code>] function performs network
meta-analysis for multiple treatments.</p>
<div class="section level3">
<h3 id="basic-nma">Basic NMA<a class="anchor" aria-label="anchor" href="#basic-nma"></a>
</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">nma_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  study <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S4"</span><span class="op">)</span>,</span>
<span>  treat1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span><span class="op">)</span>,</span>
<span>  treat2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"C"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span>  effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.75</span>, <span class="fl">0.90</span>, <span class="fl">0.80</span>, <span class="fl">0.85</span><span class="op">)</span><span class="op">)</span>,</span>
<span>  se <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.12</span>, <span class="fl">0.15</span>, <span class="fl">0.18</span>, <span class="fl">0.14</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">nma</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/network_meta.html">network_meta</a></span><span class="op">(</span><span class="va">nma_data</span>, effect_measure <span class="op">=</span> <span class="st">"hr"</span><span class="op">)</span></span>
<span><span class="va">nma</span><span class="op">@</span><span class="va">comparisons</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 9</span></span></span>
<span><span class="co">#&gt;   treatment vs    estimate ci_lower ci_upper    se n_studies evidence   rank</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A         A        1        1        1     0            <span style="color: #BB0000;">NA</span> reference    <span style="color: #BB0000;">NA</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B         A        0.75     0.593    0.949 0.12          1 direct        2</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C         A        0.8      0.562    1.14  0.18          1 direct        3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> D         A        0.638    0.444    0.915 0.184         2 indirect      1</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="network-geometry-plot">Network Geometry Plot<a class="anchor" aria-label="anchor" href="#network-geometry-plot"></a>
</h3>
<p>The [<code><a href="../reference/create_network_plot.html">create_network_plot()</a></code>] function creates network
geometry plots to visualize treatment networks.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">net_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_network_plot.html">create_network_plot</a></span><span class="op">(</span><span class="va">nma</span>, title <span class="op">=</span> <span class="st">"Treatment Network"</span><span class="op">)</span></span>
<span><span class="va">net_plot</span><span class="op">@</span><span class="va">plot</span></span></code></pre></div>
<p><img src="meta-analysis_files/figure-html/network-plot-1.png" class="r-plt" alt="Network geometry plot" width="672"></p>
</div>
<div class="section level3">
<h3 id="sucra-rankings">SUCRA Rankings<a class="anchor" aria-label="anchor" href="#sucra-rankings"></a>
</h3>
<p>The [<code><a href="../reference/calculate_sucra.html">calculate_sucra()</a></code>] function calculates SUCRA
(Surface Under the Cumulative Ranking) scores for treatment
rankings.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sucra</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calculate_sucra.html">calculate_sucra</a></span><span class="op">(</span><span class="va">nma</span><span class="op">)</span></span>
<span><span class="va">sucra</span><span class="op">$</span><span class="va">ranking</span></span>
<span><span class="co">#&gt;   treatment mean_rank    sucra prob_best prob_worst final_rank</span></span>
<span><span class="co">#&gt; D         D     1.614 79.53333     0.585      0.027          1</span></span>
<span><span class="co">#&gt; B         B     2.141 61.96667     0.216      0.020          2</span></span>
<span><span class="co">#&gt; C         C     2.422 52.60000     0.199      0.122          3</span></span>
<span><span class="co">#&gt; A         A     3.823  5.90000     0.000      0.831          4</span></span>
<span><span class="va">sucra</span><span class="op">$</span><span class="va">interpretation</span></span>
<span><span class="co">#&gt; [1] "Treatment ranking by lower is better (SUCRA, %). Best: D (79.5%), Worst: A (5.9%)"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="league-table">League Table<a class="anchor" aria-label="anchor" href="#league-table"></a>
</h3>
<p>The [<code><a href="../reference/create_league_table.html">create_league_table()</a></code>] function creates league
tables showing pairwise treatment comparisons.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">league</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_league_table.html">create_league_table</a></span><span class="op">(</span><span class="va">nma</span><span class="op">)</span></span>
<span><span class="va">league</span><span class="op">@</span><span class="va">data</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 4 × 5</span></span></span>
<span><span class="co">#&gt;   Treatment A                  B                  C                 D           </span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A         A                  1.33 (1.05, 1.69)* 1.25 (0.88, 1.78) 1.57 (1.09,…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B         0.75 (0.59, 0.95)* B                  0.94 (0.61, 1.43) 1.18 (0.76,…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> C         0.80 (0.56, 1.14)  1.07 (0.70, 1.63)  C                 1.25 (0.76,…</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> D         0.64 (0.44, 0.92)* 0.85 (0.55, 1.31)  0.80 (0.48, 1.32) D</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="transitivity-assessment">Transitivity Assessment<a class="anchor" aria-label="anchor" href="#transitivity-assessment"></a>
</h3>
<p>The [<code><a href="../reference/assess_transitivity.html">assess_transitivity()</a></code>] function assesses the
transitivity assumption in network meta-analysis.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">chars</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  study_id <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"S1"</span>, <span class="st">"S1"</span>, <span class="st">"S2"</span>, <span class="st">"S2"</span>, <span class="st">"S3"</span>, <span class="st">"S3"</span>, <span class="st">"S4"</span>, <span class="st">"S4"</span><span class="op">)</span>,</span>
<span>  treatment <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"B"</span>, <span class="st">"D"</span><span class="op">)</span>,</span>
<span>  mean_age <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">55</span>, <span class="fl">55</span>, <span class="fl">58</span>, <span class="fl">58</span>, <span class="fl">52</span>, <span class="fl">52</span>, <span class="fl">60</span>, <span class="fl">60</span><span class="op">)</span>,</span>
<span>  pct_male <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">60</span>, <span class="fl">60</span>, <span class="fl">65</span>, <span class="fl">65</span>, <span class="fl">55</span>, <span class="fl">55</span>, <span class="fl">70</span>, <span class="fl">70</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">transit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/assess_transitivity.html">assess_transitivity</a></span><span class="op">(</span></span>
<span>  study_characteristics <span class="op">=</span> <span class="va">chars</span>,</span>
<span>  char_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean_age"</span>, <span class="st">"pct_male"</span><span class="op">)</span>,</span>
<span>  continuous_vars <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"mean_age"</span>, <span class="st">"pct_male"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="va">transit</span><span class="op">$</span><span class="va">overall_assessment</span></span>
<span><span class="co">#&gt; [1] "Transitivity assumption appears reasonable"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="consistency-assessment">Consistency Assessment<a class="anchor" aria-label="anchor" href="#consistency-assessment"></a>
</h2>
<p>A key assumption in network meta-analysis is consistency between
direct and indirect evidence. pharmhand provides tools to assess this
assumption.</p>
<div class="section level3">
<h3 id="comparing-direct-and-indirect-evidence">Comparing Direct and Indirect Evidence<a class="anchor" aria-label="anchor" href="#comparing-direct-and-indirect-evidence"></a>
</h3>
<p>When both direct (head-to-head) and indirect evidence exist for a
comparison, we can test whether they agree:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Suppose we have direct evidence for A vs B from a head-to-head trial</span></span>
<span><span class="va">direct</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  estimate <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.78</span><span class="op">)</span>,</span>
<span>  se <span class="op">=</span> <span class="fl">0.14</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># And indirect evidence via common comparator C</span></span>
<span><span class="va">indirect</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/indirect_comparison.html">indirect_comparison</a></span><span class="op">(</span></span>
<span>  effect_ab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.75</span><span class="op">)</span>,  <span class="co"># A vs C</span></span>
<span>  se_ab <span class="op">=</span> <span class="fl">0.12</span>,</span>
<span>  effect_bc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">0.96</span><span class="op">)</span>,  <span class="co"># B vs C</span></span>
<span>  se_bc <span class="op">=</span> <span class="fl">0.11</span>,</span>
<span>  effect_measure <span class="op">=</span> <span class="st">"hr"</span>,</span>
<span>  label_a <span class="op">=</span> <span class="st">"A"</span>,</span>
<span>  label_b <span class="op">=</span> <span class="st">"C"</span>,</span>
<span>  label_c <span class="op">=</span> <span class="st">"B"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>[<code><a href="../reference/compare_direct_indirect.html">compare_direct_indirect()</a></code>] compares direct and indirect
evidence for consistency.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Compare direct and indirect evidence</span></span>
<span><span class="va">consistency</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compare_direct_indirect.html">compare_direct_indirect</a></span><span class="op">(</span></span>
<span>  direct_result <span class="op">=</span> <span class="va">direct</span>,</span>
<span>  indirect_result <span class="op">=</span> <span class="va">indirect</span>,</span>
<span>  effect_measure <span class="op">=</span> <span class="st">"hr"</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">consistency</span><span class="op">$</span><span class="va">direct_estimate</span></span>
<span><span class="co">#&gt; [1] 0.78</span></span>
<span><span class="va">consistency</span><span class="op">$</span><span class="va">indirect_estimate</span></span>
<span><span class="co">#&gt; [1] 0.78125</span></span>
<span><span class="va">consistency</span><span class="op">$</span><span class="va">inconsistency_p</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">consistency</span><span class="op">$</span><span class="va">is_consistent</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
<p>A non-significant p-value (p &gt; 0.05) suggests the direct and
indirect evidence are consistent, supporting the validity of the
indirect comparison.</p>
</div>
<div class="section level3">
<h3 id="node-splitting-analysis">Node-Splitting Analysis<a class="anchor" aria-label="anchor" href="#node-splitting-analysis"></a>
</h3>
<p>The [<code><a href="../reference/node_splitting.html">node_splitting()</a></code>] function performs node-splitting
analysis to assess inconsistency in network meta-analysis.</p>
<p>For network meta-analyses, node-splitting separates direct and
indirect evidence for each comparison to identify potential
inconsistencies:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Node-splitting analysis on our NMA</span></span>
<span><span class="va">ns</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/node_splitting.html">node_splitting</a></span><span class="op">(</span><span class="va">nma</span><span class="op">)</span></span>
<span><span class="va">ns</span><span class="op">$</span><span class="va">results</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 17</span></span></span>
<span><span class="co">#&gt;   comparison reference direct_estimate direct_se direct_ci_lower direct_ci_upper</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> A vs B     A                    0.75      0.12           0.593           0.949</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> B vs C     A                    0.9       0.15           0.671           1.21 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> A vs C     A                    0.8       0.18           0.562           1.14 </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># ℹ 11 more variables: n_direct &lt;int&gt;, indirect_estimate &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   indirect_se &lt;dbl&gt;, indirect_ci_lower &lt;dbl&gt;, indirect_ci_upper &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   n_indirect &lt;int&gt;, bridge &lt;chr&gt;, inconsistency_z &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   inconsistency_p &lt;dbl&gt;, model &lt;chr&gt;, conf_level &lt;dbl&gt;</span></span></span>
<span><span class="va">ns</span><span class="op">$</span><span class="va">note</span></span>
<span><span class="co">#&gt; [1] "Full node-splitting requires re-analysis excluding direct evidence. Results shown are simplified."</span></span></code></pre></div>
<p>Node-splitting helps identify specific comparisons where direct and
indirect evidence may disagree, which could indicate violations of the
transitivity assumption.</p>
</div>
</div>
<div class="section level2">
<h2 id="bayesian-meta-analysis">Bayesian Meta-Analysis<a class="anchor" aria-label="anchor" href="#bayesian-meta-analysis"></a>
</h2>
<p>For researchers preferring Bayesian inference, pharmhand provides an
interface to Bayesian meta-analysis using the brms package via the
[<code><a href="../reference/bayesian_meta_analysis.html">bayesian_meta_analysis()</a></code>] function. This allows
specification of informative priors and provides full posterior
distributions.</p>
<div class="section level3">
<h3 id="basic-bayesian-meta-analysis">Basic Bayesian Meta-Analysis<a class="anchor" aria-label="anchor" href="#basic-bayesian-meta-analysis"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Bayesian random-effects meta-analysis</span></span>
<span><span class="co"># Requires: install.packages("brms")</span></span>
<span><span class="va">bayes_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesian_meta_analysis.html">bayesian_meta_analysis</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  study_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Study"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>,</span>
<span>  effect_measure <span class="op">=</span> <span class="st">"hr"</span>,</span>
<span>  prior_mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">10</span><span class="op">)</span>,</span>
<span>  prior_tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"half_cauchy"</span>, scale <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">4000</span>,</span>
<span>  adapt_delta <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>  max_treedepth <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  seed <span class="op">=</span> <span class="fl">12345</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Posterior summary statistics</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">posterior_mean</span>      <span class="co"># Mean of posterior distribution</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">posterior_median</span>    <span class="co"># Median of posterior distribution</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">ci_95</span>               <span class="co"># 95% credible interval</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">prob_benefit</span>        <span class="co"># P(HR &lt; 1)</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">prob_superior</span>       <span class="co"># P(HR &lt; 0.9)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="convergence-diagnostics">Convergence Diagnostics<a class="anchor" aria-label="anchor" href="#convergence-diagnostics"></a>
</h3>
<p>The [<code><a href="../reference/bayesian_meta_analysis.html">bayesian_meta_analysis()</a></code>] function now
automatically reports convergence diagnostics to ensure reliable
results:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Access convergence diagnostics</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">convergence_diagnostics</span></span>
<span></span>
<span><span class="co"># Check individual metrics</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">convergence_diagnostics</span><span class="op">$</span><span class="va">max_rhat</span>      <span class="co"># Should be &lt;= 1.01</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">convergence_diagnostics</span><span class="op">$</span><span class="va">min_bulk_ess</span> <span class="co"># Should be &gt;= 400</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">convergence_diagnostics</span><span class="op">$</span><span class="va">min_tail_ess</span> <span class="co"># Should be &gt;= 400</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">convergence_diagnostics</span><span class="op">$</span><span class="va">divergent_transitions</span> <span class="co"># Should be 0</span></span></code></pre></div>
<p>Warnings are automatically issued when convergence issues are
detected. To improve convergence:</p>
<ul>
<li>Increase <code>adapt_delta</code> parameter (try 0.99 or 0.999)</li>
<li>Increase <code>iter</code> for more samples</li>
<li>Use more informative priors</li>
</ul>
</div>
<div class="section level3">
<h3 id="predictive-checks">Predictive Checks<a class="anchor" aria-label="anchor" href="#predictive-checks"></a>
</h3>
<div class="section level4">
<h4 id="posterior-predictive-checks">Posterior Predictive Checks<a class="anchor" aria-label="anchor" href="#posterior-predictive-checks"></a>
</h4>
<p>Assess model fit to the observed data:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Enable posterior predictive checks</span></span>
<span><span class="va">bayes_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesian_meta_analysis.html">bayesian_meta_analysis</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  effect_measure <span class="op">=</span> <span class="st">"hr"</span>,</span>
<span>  posterior_predictive <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  pp_check_type <span class="op">=</span> <span class="st">"dens_overlay"</span>,</span>
<span>  pp_ndraws <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View posterior predictive plot</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">pp_check_plot</span></span>
<span></span>
<span><span class="co"># Check Bayesian p-value (should be around 0.5 for good fit)</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">posterior_predictive</span><span class="op">$</span><span class="va">bayes_p_value</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="prior-predictive-checks">Prior Predictive Checks<a class="anchor" aria-label="anchor" href="#prior-predictive-checks"></a>
</h4>
<p>Evaluate prior reasonableness before seeing data:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Fit with prior-only</span></span>
<span><span class="va">bayes_result</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/bayesian_meta_analysis.html">bayesian_meta_analysis</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  effect_measure <span class="op">=</span> <span class="st">"hr"</span>,</span>
<span>  prior_predictive <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View prior distribution</span></span>
<span><span class="va">bayes_result</span><span class="op">$</span><span class="va">prior_predictive</span><span class="op">$</span><span class="va">summary</span></span></code></pre></div>
</div>
</div>
<div class="section level3">
<h3 id="trace-plots">Trace Plots<a class="anchor" aria-label="anchor" href="#trace-plots"></a>
</h3>
<p>The [<code><a href="../reference/create_bayesian_trace_plots.html">create_bayesian_trace_plots()</a></code>] function visualizes
MCMC chain convergence:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create combined trace plots</span></span>
<span><span class="va">trace_plot</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_bayesian_trace_plots.html">create_bayesian_trace_plots</a></span><span class="op">(</span><span class="va">bayes_result</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trace_plot</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Create individual parameter plots</span></span>
<span><span class="va">trace_plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_bayesian_trace_plots.html">create_bayesian_trace_plots</a></span><span class="op">(</span></span>
<span>  <span class="va">bayes_result</span>,</span>
<span>  parameters <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b_Intercept"</span>, <span class="st">"sd_study__Intercept"</span><span class="op">)</span>,</span>
<span>  combine_plots <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">trace_plots</span><span class="op">$</span><span class="va">b_Intercept</span><span class="op">)</span></span></code></pre></div>
<p>Good convergence shows: - Well-mixed chains (no drift or stickiness)
- Similar distributions across chains - Rapid autocorrelation decay</p>
</div>
<div class="section level3">
<h3 id="prior-sensitivity-analysis">Prior Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#prior-sensitivity-analysis"></a>
</h3>
<p>The [<code><a href="../reference/prior_sensitivity_analysis.html">prior_sensitivity_analysis()</a></code>] function tests how
results change with different prior specifications:</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run sensitivity analysis with default scenarios</span></span>
<span><span class="va">sensitivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prior_sensitivity_analysis.html">prior_sensitivity_analysis</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  effect_measure <span class="op">=</span> <span class="st">"hr"</span>,</span>
<span>  chains <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  iter <span class="op">=</span> <span class="fl">2000</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compare estimates across priors</span></span>
<span><span class="va">sensitivity</span><span class="op">$</span><span class="va">comparison</span></span>
<span></span>
<span><span class="co"># View robustness summary</span></span>
<span><span class="va">sensitivity</span><span class="op">$</span><span class="va">sensitivity_summary</span><span class="op">$</span><span class="va">robustness_interpretation</span></span></code></pre></div>
<p>Or specify custom prior scenarios:</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">custom_scenarios</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  skeptical <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    prior_mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fl">0</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>    prior_tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"half_cauchy"</span>, scale <span class="op">=</span> <span class="fl">0.3</span><span class="op">)</span></span>
<span>  <span class="op">)</span>,</span>
<span>  optimistic <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    prior_mu <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span>, sd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>    prior_tau <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>type <span class="op">=</span> <span class="st">"half_cauchy"</span>, scale <span class="op">=</span> <span class="fl">0.2</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">sensitivity</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/prior_sensitivity_analysis.html">prior_sensitivity_analysis</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  effect_measure <span class="op">=</span> <span class="st">"hr"</span>,</span>
<span>  prior_scenarios <span class="op">=</span> <span class="va">custom_scenarios</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="iqwig-compliant-reporting">IQWiG-Compliant Reporting<a class="anchor" aria-label="anchor" href="#iqwig-compliant-reporting"></a>
</h3>
<p>The [<code><a href="../reference/format_bayesian_result_iqwig.html">format_bayesian_result_iqwig()</a></code>] function formats
Bayesian results for German HTA submissions:</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Format for IQWiG submission</span></span>
<span><span class="va">formatted</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/format_bayesian_result_iqwig.html">format_bayesian_result_iqwig</a></span><span class="op">(</span></span>
<span>  <span class="va">bayes_result</span>,</span>
<span>  locale <span class="op">=</span> <span class="st">"de"</span>  <span class="co"># German locale</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># View formatted components</span></span>
<span><span class="va">formatted</span><span class="op">$</span><span class="va">estimate</span>      <span class="co"># "0.790"</span></span>
<span><span class="va">formatted</span><span class="op">$</span><span class="va">ci</span>           <span class="co"># "[0.712; 0.877]"</span></span>
<span><span class="va">formatted</span><span class="op">$</span><span class="va">probability</span>   <span class="co"># "P(HR &lt; 1) = 98.5%"</span></span>
<span><span class="va">formatted</span><span class="op">$</span><span class="va">interpretation</span> <span class="co"># Complete interpretation</span></span>
<span></span>
<span><span class="co"># Export full formatted text</span></span>
<span><span class="va">formatted</span><span class="op">$</span><span class="va">full_text</span></span></code></pre></div>
<p>The [<code><a href="../reference/create_bayesian_forest_plot_iqwig.html">create_bayesian_forest_plot_iqwig()</a></code>] function
creates IQWiG-compliant forest plots:</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create IQWiG-formatted forest plot</span></span>
<span><span class="va">study_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span>
<span>  yi <span class="op">=</span> <span class="va">yi</span>,</span>
<span>  sei <span class="op">=</span> <span class="va">sei</span>,</span>
<span>  study_labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Study"</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">forest_iqwig</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/create_bayesian_forest_plot_iqwig.html">create_bayesian_forest_plot_iqwig</a></span><span class="op">(</span></span>
<span>  <span class="va">bayes_result</span>,</span>
<span>  study_data <span class="op">=</span> <span class="va">study_data</span>,</span>
<span>  locale <span class="op">=</span> <span class="st">"de"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Behandlungseffekt (HR)"</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">forest_iqwig</span><span class="op">)</span></span></code></pre></div>
<p><strong>Note:</strong> Bayesian meta-analysis requires the
<code>brms</code> package and a working Stan installation. Install with
<code>install.packages("brms")</code>. For users without brms, the
frequentist [<code><a href="../reference/meta_analysis.html">meta_analysis()</a></code>] function provides an
alternative.</p>
<p>Advantages of the Bayesian approach include:</p>
<ul>
<li>Natural interpretation of credible intervals as probability
statements</li>
<li>Ability to incorporate prior knowledge</li>
<li>Full posterior distributions for all parameters</li>
<li>Better handling of small sample sizes</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="summary">Summary<a class="anchor" aria-label="anchor" href="#summary"></a>
</h2>
<p>pharmhand provides a complete toolkit for evidence synthesis:</p>
<table class="table">
<colgroup>
<col width="52%">
<col width="47%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Purpose</th>
</tr></thead>
<tbody>
<tr class="odd">
<td>[<code><a href="../reference/meta_analysis.html">meta_analysis()</a></code>]</td>
<td>Fixed/random-effects meta-analysis</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/calculate_heterogeneity.html">calculate_heterogeneity()</a></code>]</td>
<td>Q, I², τ² statistics</td>
</tr>
<tr class="odd">
<td>[<code><a href="../reference/leave_one_out.html">leave_one_out()</a></code>]</td>
<td>Sensitivity analysis</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/create_meta_forest_plot.html">create_meta_forest_plot()</a></code>]</td>
<td>Forest plot visualization</td>
</tr>
<tr class="odd">
<td>[<code><a href="../reference/create_funnel_plot.html">create_funnel_plot()</a></code>]</td>
<td>Publication bias assessment</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/eggers_test.html">eggers_test()</a></code>]</td>
<td>Funnel asymmetry test</td>
</tr>
<tr class="odd">
<td>[<code><a href="../reference/trim_and_fill.html">trim_and_fill()</a></code>]</td>
<td>Bias adjustment</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/indirect_comparison.html">indirect_comparison()</a></code>]</td>
<td>Bucher indirect comparison</td>
</tr>
<tr class="odd">
<td>[<code><a href="../reference/compare_direct_indirect.html">compare_direct_indirect()</a></code>]</td>
<td>Test direct vs indirect consistency</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/network_meta.html">network_meta()</a></code>]</td>
<td>Network meta-analysis</td>
</tr>
<tr class="odd">
<td>[<code><a href="../reference/create_network_plot.html">create_network_plot()</a></code>]</td>
<td>Network geometry</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/calculate_sucra.html">calculate_sucra()</a></code>]</td>
<td>Treatment rankings</td>
</tr>
<tr class="odd">
<td>[<code><a href="../reference/create_league_table.html">create_league_table()</a></code>]</td>
<td>Pairwise comparisons</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/assess_transitivity.html">assess_transitivity()</a></code>]</td>
<td>Transitivity check</td>
</tr>
<tr class="odd">
<td>[<code><a href="../reference/node_splitting.html">node_splitting()</a></code>]</td>
<td>NMA inconsistency testing</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/bayesian_meta_analysis.html">bayesian_meta_analysis()</a></code>]</td>
<td>Bayesian meta-analysis (via brms)</td>
</tr>
<tr class="odd">
<td>[<code><a href="../reference/create_bayesian_trace_plots.html">create_bayesian_trace_plots()</a></code>]</td>
<td>MCMC trace plot visualization</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/prior_sensitivity_analysis.html">prior_sensitivity_analysis()</a></code>]</td>
<td>Prior sensitivity analysis</td>
</tr>
<tr class="odd">
<td>[<code><a href="../reference/format_bayesian_result_iqwig.html">format_bayesian_result_iqwig()</a></code>]</td>
<td>IQWiG formatting for Bayesian results</td>
</tr>
<tr class="even">
<td>[<code><a href="../reference/create_bayesian_forest_plot_iqwig.html">create_bayesian_forest_plot_iqwig()</a></code>]</td>
<td>IQWiG-compliant forest plots</td>
</tr>
</tbody>
</table>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/sims1253" class="external-link">Maximilian Scholz</a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
